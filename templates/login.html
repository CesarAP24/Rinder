<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="styles/styles.css">
	<title>Únete a la comunidad de Rinder</title>
    <link rel="stylesheet" href="styles/login_register.css">
    <script type="text/javascript" src="scripts/cifrado.js"></script>
    <script src="./bcrypt.js"></script>
</head>
<body>
	<!-- Formulario de registro -->
    <div class = "logo">
        <img src="images/logofucsia.PNG" alt="logo" id="logoinicio">
    </div>
    <div class = "main_container">
        <section id="register-section">
	<!-- <h2>Regístrate</h2> -->
	<form action="/registro" method="POST">
        <div class ="container_register">
            <label id= "datos" for="datos">Regístrate aquí</label>
                <div id="encap">
            <input type="text" name="nombre" id="nombre" required placeholder="Ingrese su nombre">

            <!-- <label for="apellido">Apellido</label> -->
            <input type="text" name="apellido" id="apellido" required placeholder="Ingrese su apellido">
                </div>

            <label for="email">Correo electrónico</label>
            <input type="email" name="email" id="email" required placeholder="Ingrese su correo electrónico">
            <div id="mensaje-mail" style="display:none;">Ingrese un email válido.</div>    


            <label for="fecha_nacimiento">Fecha de nacimiento</label>
            <input type="date" name="fecha_nacimiento" id="fecha_nacimiento" required placeholder="Ingrese su fecha de nacimiento">
            <div id="mensaje-menor-edad" style="display:none;">Lo sentimos, debes ser mayor de edad para acceder a este sitio.</div>

            <label for="username">Username</label>
            <input type="text" name="user" id="u-username" required placeholder="Ingrese su usuario">

            <label for="password">Contraseña</label>
            <input type="password" name="password" id="password" required placeholder="Ingrese su contraseña">

            <!-- <label for="password">Confirme la contraseña</label> -->
            <input type="password" name="password" id="password_confirmed" required placeholder="Confirme su contraseña">
            <div id="contraseñas_distintas" style="display:none;">Las contraseñas no coinciden.</div>

            <!-- Agregar este div en el HTML donde se quiere mostrar el mensaje -->

            <button type="submit" onclick="validarTodo(event)">Registrarse</button>
            
        </div>
	</form>
</section>
</div>

	<!-- Formulario de inicio de sesión -->
    <div class = "main_container">
        <section id="login-section">
	<!-- <h2>Iniciar sesión</h2> -->
        <form action="/login" method="POST">
            <div class ="container_register" >
                <label for="email_login">Username:</label>
                <input type="email" name="email_login" id="email_login" required placeholder="Ingrese su email">
                <div id="mensaje-mail" style="display:none;">Ingrese un email válido.</div>
                <label for="password_login">Contraseña:</label>
                <input type="password" name="password_login" id="password_login" required placeholder="Ingrese su contraseña">
                <div id="contrasena_incorrecta" style="display:none;">Las contraseña es incorrecta.</div>
        
                <button type="submit" onclick="validarClave(event)">Iniciar Sesion</button>
                </div>
        </form>
        <p>¿No tienes una cuenta? <a href="#" id="show-register">Regístrate aquí</a></p>
    </section>
    </div>
</body>
<script>

    const showRegisterLink = document.getElementById('show-register');
    const showLoginLink = document.getElementById('show-login');
    const loginSection = document.getElementById('login-section');
    const registerSection = document.getElementById('register-section');
    const registerBtn = document.getElementById('register-btn');

// Cuando se hace clic en el enlace para registrarse desde el formulario de inicio de sesión, ocultar el formulario de inicio de sesión y mostrar el de registro, y mostrar el botón de "Registrarse"
showRegisterLink.addEventListener('click', function(event) {
  event.preventDefault();
  loginSection.style.display = 'none';
  registerSection.style.display = 'block';
  registerBtn.style.display = 'inline-block';
});

// Cuando se hace clic en el enlace para iniciar sesión desde el formulario de registro, ocultar el formulario de registro y mostrar el de inicio de sesión, y ocultar el botón de "Registrarse"
showLoginLink.addEventListener('click', function(event) {
  event.preventDefault();
  registerSection.style.display = 'none';
  loginSection.style.display = 'block';
  registerBtn.style.display = 'none';
});



        // FUNCION PARA VALIDAR EDAD

        function validarEdad(event) {
			event.preventDefault(); // evita que se envíe el formulario

			// obtener la fecha de nacimiento ingresada
			const fechaNacimiento = new Date(document.getElementById('fecha_nacimiento').value);

			// calcular la edad
			const hoy = new Date();
			const edad = hoy.getFullYear() - fechaNacimiento.getFullYear();
			const m = hoy.getMonth() - fechaNacimiento.getMonth();
			if (m < 0 || (m === 0 && hoy.getDate() < fechaNacimiento.getDate())) {
				edad--;
			}

			// mostrar el mensaje de error si no es mayor de edad
			if (edad < 18) {
				document.getElementById('mensaje-menor-edad').style.display = 'block';
			} else {
				// enviar el formulario si es mayor de edad
				validarContrasena(event);
			}
		}



        //FUNCION PARA VALIDAR CONTRASENA
    
        function validarContrasena(event){
            event.preventDefault();
            const password = document.getElementById('password').value;
            const password_confirmed = document.getElementById('password_confirmed').value;
            
            if(password != password_confirmed){
                document.getElementById('contraseñas_distintas').style.display = 'block';
            } else {
                validarMail(event);
            }
        }

        //FUNCION VALIDAR MAIL

        function validarMail(event){
            event.preventDefault();
            const email = document.getElementById('email').value;
            const regex = /\S+@\S+\.\S+/;
            if (regex.test(email) == false){
                document.getElementById('mensaje-mail').style.display = 'block';
            } else {
                validarTodo(event);
            }
        }


        function validarTodo(event){
            validarEdad(event);
            validarContrasena(event);
            validarMail(event);
        }

        
  </script>
</html>